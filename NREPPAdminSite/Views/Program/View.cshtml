@model NREPPAdminSite.Models.IntervPageModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var NumDocs = Model.Documents.Count;
}

<h2>Viewing @Model.TheIntervention.Title</h2>
<h3>Submitted by @Model.TheIntervention.Submitter</h3>

<div>
    <div style="padding-top: 10px; padding-bottom: 10px;">
        @Model.TheIntervention.FullDescription
    </div>

    <div style="height: 45px;">
        <span style="float: left; clear: left;">
            Last Updated On:
        </span>
        <span style="float: left; clear: right; margin-left: 5px;">@Model.TheIntervention.UpdatedDate.ToShortDateString()</span>

        <span style="float: left; clear: left;">
            Published On:
        </span>
        <span style="float: left; clear: right; margin-left: 5px;">@(Model.TheIntervention.PublishDate.HasValue ? Model.TheIntervention.PublishDate.GetValueOrDefault().ToShortDateString() : "Not Published")</span>
    </div>

    <div>
        @using(Html.BeginForm("Edit", "Program"))
        {
            @Html.HiddenFor(m => m.TheIntervention.Id);
            @Html.HiddenFor(m => m.TheIntervention.SubmitterId);
            @Html.HiddenFor(m => m.TheIntervention.StatusId);
            @Html.HiddenFor(m => m.TheIntervention.ProgramType, new { Id = "programType" });
            
            @Html.LabelFor(m => m.TheIntervention.Title, new { style = "margin-right: 5px;" });
            @Html.TextBoxFor(m => m.TheIntervention.Title);<br />
            
            @Html.LabelFor(m => m.TheIntervention.Acronym, new { style = "margin-right: 5px;" });
            @Html.TextBoxFor(m => m.TheIntervention.Acronym);
            <br /><br />
            
            @Html.LabelFor(m => m.TheIntervention.FullDescription);
            <br />
            @Html.TextAreaFor(m => m.TheIntervention.FullDescription, new {cols = "150", rows = "5"}) ;
            <br /><br />
            
            foreach (NREPPAdminSite.Models.MaskValue mask in Model.ProgramType)
            {
                bool isChecked = mask.Selected;
                @Html.CheckBox(mask.Name, isChecked, new { Value = Math.Pow(2, mask.Value), @class = "programMask" }) @mask.Name <br />
            }
            <br /><br />

            <input type="submit" value="Update" />
        }
    </div>

    @if (Model.TheIntervention.Id > 0)
    {
        <div style="margin-top: 20px;">
            <span class="collapsedText hidden">@NumDocs Documents On this Intervention</span>
            <table style="border: 1px solid;">
                <tr> <!-- Header -->
                    <th class="withborder" style="text-align: center;">Description</th>
                    <th class="withborder" style="text-align: center;">Type</th>
                    <th class="withborder" style="text-align: center;">&nbsp;</th>
                </tr>
                @foreach (NREPPAdminSite.Models.InterventionDoc doc in Model.Documents)
                {
                    <tr>
                        <td class="withborder">@doc.FileDescription</td>
                        <td class="withborder">@doc.DocumentTypeName</td>
                        <td class="withborder">@Html.ActionLink("Delete", "DeleteDocument", new { InvId = "1", DocId = doc.DocId })</td>
                        <!-- Need to Add Type -->
                    </tr>
                }
            </table>
            @{
                List<SelectListItem> DocTypez = new List<SelectListItem>();
                
                foreach(NREPPAdminSite.Models.Answer ans in Model.DocumentType)
                {
                    DocTypez.Add(new SelectListItem() { Text = ans.ShortAnswer, Value = ans.AnswerId.ToString() });
                }
            }

            @using (Html.BeginForm("Upload", "Program", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                @Html.HiddenFor(m => m.TheIntervention.Id);
                @Html.HiddenFor(m => m.TheIntervention.SubmitterId);
                @Html.HiddenFor(m => m.TheIntervention.StatusId);
                @Html.HiddenFor(m => m.TheIntervention.ProgramType);
                //@Html.HiddenFor(m => )
                
                <span>File: </span><input type="file" name="UploadedFile" /> <br />
                <span>Document Title: </span><input type="text" name="FileDescription" />
                @Html.DropDownList("someDD", DocTypez);
                <br /><br />
                <input type="submit" value="Submit" />
            }
        </div>
    }
    else
    {
        <div>
            You may upload files after initially saving 
        </div>
    }
</div>

